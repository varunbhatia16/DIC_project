set mapred.reduce.tasks={{num_partitions}};
set hive.map.aggr=false;
drop table if exists denorm_cached;
create table denorm_cached as
select --SPREAD_EVENLY--
r_regionkey, l_linenumber, r_name, n_nationkey, n_name, s_suppkey, s_name, s_address, s_nationkey, s_phone, s_acctbal, s_comment, ps_partkey, ps_suppkey, ps_availqty, ps_supplycost, p_partkey, p_name, p_mfgr, p_brand, p_type, p_size, p_container, l_orderkey, l_partkey, l_suppkey, l_quantity, l_extendedprice, l_discount, l_returnflag, l_shipdate, l_linestatus, l_commitdate, l_receiptdate, l_shipinstruct, l_shipmode, l_tax, o_orderkey, o_custkey, o_orderstatus, o_totalprice, o_orderdate, o_orderpriority, o_shippriority, o_comment, c_nationkey, c_custkey, c_name, c_mktsegment
from denorm
group by r_regionkey, l_linenumber, r_name, n_nationkey, n_name, s_suppkey, s_name, s_address, s_nationkey, s_phone, s_acctbal, s_comment, ps_partkey, ps_suppkey, ps_availqty, ps_supplycost, p_partkey, p_name, p_mfgr, p_brand, p_type, p_size, p_container, l_orderkey, l_partkey, l_suppkey, l_quantity, l_extendedprice, l_discount, l_returnflag, l_shipdate, l_linestatus, l_commitdate, l_receiptdate, l_shipinstruct, l_shipmode, l_tax, o_orderkey, o_custkey, o_orderstatus, o_totalprice, o_orderdate, o_orderpriority, o_shippriority, o_comment, c_nationkey, c_custkey, c_name, c_mktsegment;
set hive.map.aggr=true;
select --SPREAD_EVENLY--
count(*) from denorm_cached;
select --SPREAD_EVENLY--
count(*) from denorm_cached;
set mapred.reduce.tasks={{reduce_tasks}};
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
select --3-- 
  l_orderkey, sum(l_extendedprice*(1-l_discount)) as revenue, o_orderdate, o_shippriority 
from 
  denorm_cached
where 
  o_orderdate < '1995-03-15' and l_shipdate > '1995-03-15' and c_mktsegment = 'BUILDING'
group by l_orderkey, o_orderdate, o_shippriority 
order by revenue desc, o_orderdate 
limit 10;
select --6--
sum(l_extendedprice*l_discount) as revenue
from 
  denorm_cached
where 
  l_shipdate >= '1994-01-01'
  and l_shipdate < '1995-01-01'
  and l_discount >= 0.05 and l_discount <= 0.07
  and l_quantity < 24;
select --12--
  l_shipmode,
  sum(case
    when o_orderpriority ='1-URGENT'
         or o_orderpriority ='2-HIGH'
    then 1
    else 0
end
  ) as high_line_count,
  sum(case
    when o_orderpriority <> '1-URGENT'
         and o_orderpriority <> '2-HIGH'
    then 1
    else 0
end
  ) as low_line_count

from denorm_cached
where 
  l_receiptdate < '1995-01-01' and
  (l_shipmode = 'MAIL' or l_shipmode = 'SHIP') and
  l_shipdate < l_commitdate and l_receiptdate >= '1994-01-01' and
  l_commitdate < l_receiptdate
group by l_shipmode
order by l_shipmode;
select --4--
  count(1), o_orderpriority from 
  (select distinct l_orderkey, o_orderpriority from denorm_cached where
    o_orderdate >= '1993-07-01' and 
    o_orderdate < '1993-10-01' and
    l_commitdate < l_receiptdate) a
  group by o_orderpriority;
